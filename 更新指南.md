# 约会盲盒 Lovebox - 内容更新指南

> 本文档详细说明如何更新约会任务、筛选选项和页面说明文字

---

## 📋 目录

1. [更新任务/活动内容](#1-更新任务活动内容)
2. [添加新的筛选选项](#2-添加新的筛选选项)
3. [更新页面说明文字](#3-更新页面说明文字)
4. [常见问题](#4-常见问题)

---

## 1. 更新任务/活动内容

### 1.1 任务数据存放位置

所有任务数据存储在：**`src/data/tasks.json`**

### 1.2 任务数据结构说明

每个任务是一个JSON对象，包含以下字段：

```json
{
  "id": 1,                                    // 任务ID，必须唯一，从1开始递增
  "stage": "刚开始谈恋爱（0-3个月）",           // 关系阶段（5个选项之一）
  "category": "深度连接",                      // 任务类别（5个选项之一）
  "title": "深度问题交流",                     // 任务标题，简短精炼
  "description": "轮流提问和回答36个问题...",   // 任务描述，详细说明做什么
  "science": "心理学家Arthur Aron的研究...",   // 科学依据，解释为什么有效
  "steps": [                                   // 行动步骤，数组格式
    "选择安静舒适的环境",
    "轮流提问和回答",
    "保持眼神接触"
  ],
  "duration": "1-2小时",                       // 所需时间（3个选项之一）
  "location": "在家",                          // 地点（2个选项之一）
  "budget": "免费"                             // 预算（3个选项之一）
}
```

### 1.3 字段取值范围

**重要：以下字段的值必须严格匹配预定义选项，否则筛选功能将无法正常工作！**

#### stage（关系阶段）- 5个选项
```
"刚开始谈恋爱（0-3个月）"
"热恋阶段（3-12个月）"
"稳定关系（1-3年）"
"结婚前准备"
"新婚阶段（结婚后1-2年）"
```

#### category（任务类别）- 5个选项
```
"冒险与新奇"
"深度连接"
"团队协作"
"玩乐与放松"
"价值与未来"
```

#### duration（所需时间）- 3个选项
```
"30分钟内"
"1-2小时"
"半天以上"
```

#### location（地点）- 2个选项
```
"在家"
"外出"
```

#### budget（预算）- 3个选项
```
"免费"
"<100元"
">100元"
```

### 1.4 如何添加新任务

**步骤1：**打开 `src/data/tasks.json` 文件

**步骤2：**找到 `"tasks"` 数组的最后一个任务

**步骤3：**在最后一个任务的 `}` 后面添加逗号 `,`，然后复制粘贴以下模板：

```json
{
  "id": 63,
  "stage": "刚开始谈恋爱（0-3个月）",
  "category": "深度连接",
  "title": "你的任务标题",
  "description": "详细描述这个任务是什么，需要做什么...",
  "science": "解释这个任务的心理学或科学依据，为什么这样做能增进感情...",
  "steps": [
    "第一步：具体的行动指南",
    "第二步：继续详细说明",
    "第三步：...",
    "第四步：..."
  ],
  "duration": "1-2小时",
  "location": "在家",
  "budget": "免费"
}
```

**步骤4：**修改模板内容：
- `id`：使用下一个可用的数字（当前最大是62，所以新任务用63）
- `stage`：从5个关系阶段中选择一个（必须完全匹配上面列出的选项）
- `category`：从5个类别中选择一个（必须完全匹配上面列出的选项）
- `title`：写一个简短有吸引力的标题
- `description`：详细描述任务内容
- `science`：说明科学依据
- `steps`：列出3-6个具体步骤
- `duration`、`location`、`budget`：选择合适的选项（必须完全匹配）

**步骤5：**保存文件，刷新浏览器测试

### 1.5 如何修改现有任务

**步骤1：**打开 `src/data/tasks.json` 文件

**步骤2：**使用 Ctrl+F 搜索你要修改的任务标题或ID

**步骤3：**直接修改对应字段的值

**步骤4：**确保修改后的JSON格式正确（注意逗号、引号、括号的配对）

**步骤5：**保存文件，刷新浏览器测试

### 1.6 如何删除任务

**步骤1：**打开 `src/data/tasks.json` 文件

**步骤2：**找到要删除的任务对象（从 `{` 到 `}`）

**步骤3：**删除整个任务对象，包括前面或后面的逗号

**步骤4：**保存文件，刷新浏览器测试

**⚠️ 注意：**删除任务不需要重新编号ID，ID可以不连续

---

## 2. 添加新的筛选选项

如果你想添加新的筛选维度（例如：适合人群、难度等级），需要修改3个文件。

### 2.1 第一步：更新任务数据 (`src/data/tasks.json`)

在每个任务对象中添加新字段：

```json
{
  "id": 1,
  "stage": "刚开始谈恋爱（0-3个月）",
  "category": "深度连接",
  // ... 其他现有字段 ...
  "difficulty": "简单"  // ← 新增字段
}
```

### 2.2 第二步：更新JavaScript逻辑 (`src/js/app.js`)

#### 2.2.1 更新筛选器状态对象

找到第11-17行的 `activeFilters` 对象，添加新字段：

```javascript
// 筛选器状态
let activeFilters = {
    stage: null,
    duration: null,
    location: null,
    budget: null,
    difficulty: null  // ← 添加新的筛选项
};
```

#### 2.2.2 更新筛选逻辑

找到第220-238行的 `getRandomTask()` 函数，在筛选逻辑中添加新条件：

```javascript
function getRandomTask() {
    let filteredTasks = allTasks.filter(task => {
        if (activeFilters.stage && task.stage !== activeFilters.stage) {
            return false;
        }
        if (activeFilters.duration && task.duration !== activeFilters.duration) {
            return false;
        }
        if (activeFilters.location && task.location !== activeFilters.location) {
            return false;
        }
        if (activeFilters.budget && task.budget !== activeFilters.budget) {
            return false;
        }
        // ← 添加新的筛选条件
        if (activeFilters.difficulty && task.difficulty !== activeFilters.difficulty) {
            return false;
        }
        return true;
    });
    // ... 其余代码 ...
}
```

#### 2.2.3 更新清除筛选函数

找到第364-372行的 `clearFilters()` 函数，添加新字段重置：

```javascript
function clearFilters() {
    activeFilters = {
        stage: null,
        duration: null,
        location: null,
        budget: null,
        difficulty: null  // ← 添加重置逻辑
    };
    // ... 其余代码 ...
}
```

### 2.3 第三步：更新HTML界面 (`index.html`)

找到第35-71行的筛选器区域，添加新的筛选按钮组：

```html
<div class="filter-group">
    <label class="filter-label">⭐ 难度：</label>
    <div class="filter-buttons">
        <button class="filter-btn" data-filter-type="difficulty" data-filter-value="简单">简单</button>
        <button class="filter-btn" data-filter-type="difficulty" data-filter-value="中等">中等</button>
        <button class="filter-btn" data-filter-type="difficulty" data-filter-value="困难">困难</button>
    </div>
</div>
```

**⚠️ 重要：**
- `data-filter-type` 的值必须和 `activeFilters` 对象中的键名一致
- `data-filter-value` 的值必须和 `tasks.json` 中该字段的值完全一致

---

## 3. 更新页面说明文字

### 3.1 更新主页标题和副标题

**文件：**`index.html`

**位置：**第24-27行

```html
<section class="welcome-section">
    <h1 class="main-title">开启你们的约会盲盒</h1>
    <p class="subtitle">每一次新奇的体验，都是感情升温的契机</p>
</section>
```

### 3.2 更新说明卡片内容

**文件：**`index.html`

**位置：**第136-166行

#### 3.2.1 更新"关于约会盲盒"说明

```html
<div class="info-card">
    <h3>🎯 关于约会盲盒</h3>
    <p>我们提供62个基于关系心理学研究精心设计的活动...</p>
    <!-- ↑ 修改这里的文字 -->
</div>
```

#### 3.2.2 更新"关系阶段"说明

```html
<div class="info-card">
    <h3>💕 5个关系阶段</h3>
    <ul class="category-list">
        <li><strong>刚开始谈恋爱（0-3个月）：</strong>快速建立信任和亲密感</li>
        <!-- ↑ 修改阶段说明 -->
        <li><strong>热恋阶段（3-12个月）：</strong>维持激情，加深承诺</li>
        <!-- ... 其他阶段 ... -->
    </ul>
</div>
```

#### 3.2.3 更新"任务类别"说明

```html
<div class="info-card">
    <h3>📚 5大任务类别</h3>
    <ul class="category-list">
        <li><strong>冒险与新奇：</strong>制造多巴胺，将兴奋感与伴侣关联</li>
        <!-- ↑ 修改类别说明 -->
        <!-- ... 其他类别 ... -->
    </ul>
</div>
```

#### 3.2.4 更新"科学基础"说明

```html
<div class="info-card">
    <h3>🧠 科学基础</h3>
    <p>所有内容基于Sternberg三角形爱情理论、Arthur Aron的36问题研究...</p>
    <!-- ↑ 修改这里的文字 -->
</div>
```

### 3.3 更新恋爱指南页面

**文件：**`guide.html`

直接修改文章内容，HTML结构保持不变

### 3.4 更新页脚文字

**文件：**`index.html`

**位置：**第169-172行

```html
<footer class="footer">
    <p>💕 愿每对情侣都能找到属于自己的幸福密码</p>
    <p class="footer-note">本应用内容基于约翰·戈特曼和阿瑟·亚伦的关系心理学研究</p>
    <!-- ↑ 修改这里的文字 -->
</footer>
```

---

## 4. 常见问题

### Q1: 修改后页面没有变化？

**A:** 清除浏览器缓存并强制刷新（Ctrl+Shift+R 或 Cmd+Shift+R）

### Q2: 添加任务后出现错误？

**A:** 检查以下几点：
1. JSON格式是否正确（使用 [JSONLint](https://jsonlint.com/) 验证）
2. 所有字符串是否用双引号包裹
3. 对象之间是否有逗号分隔
4. 最后一个对象后面不应该有逗号
5. 筛选选项的值是否完全匹配预定义选项（注意标点符号）

### Q3: 筛选功能不工作？

**A:** 确保：
1. `tasks.json` 中的字段值与 `index.html` 中的 `data-filter-value` 完全一致
2. `activeFilters` 对象包含了所有筛选项
3. `getRandomTask()` 函数中添加了对应的筛选逻辑

### Q4: 如何修改每日抽取次数限制？

**A:**
1. 打开 `src/js/app.js`
2. 找到第6行：`const MAX_DAILY_CHANGES = 3;`
3. 修改数字3为你想要的次数
4. 保存并刷新

### Q5: 如何修改筛选按钮的显示文字？

**A:** 在 `index.html` 中修改按钮内的文字，但不要修改 `data-filter-value` 的值：

```html
<!-- ✅ 正确：只改显示文字 -->
<button class="filter-btn"
        data-filter-type="duration"
        data-filter-value="30分钟内">
    超快速  <!-- ← 可以改这里 -->
</button>

<!-- ❌ 错误：改了筛选值会导致功能失效 -->
<button class="filter-btn"
        data-filter-type="duration"
        data-filter-value="快速">  <!-- ← 不要改这里！ -->
    超快速
</button>
```

### Q6: 如何添加更多关系阶段选项？

**A:** 需要同时修改3个地方：

1. **`tasks.json`** - 为任务添加新的 `stage` 值
2. **`index.html`** - 在筛选器区域添加新按钮
3. **说明区域** - 更新"5个关系阶段"列表（改标题和内容）

### Q7: 如何更改应用的主题颜色？

**A:**
1. 打开 `src/css/style.css`
2. 在文件顶部找到 `:root` 部分的颜色变量
3. 修改颜色值
4. 保存并刷新

---

## 📝 更新检查清单

完成更新后，请检查以下项目：

- [ ] JSON格式验证通过（无语法错误）
- [ ] 所有新任务的ID唯一且为数字
- [ ] 筛选选项的值完全匹配预定义选项
- [ ] 在浏览器中测试所有筛选器
- [ ] 测试抽取和换一个功能
- [ ] 测试每日重置逻辑（可修改系统日期测试）
- [ ] 检查移动端显示效果
- [ ] 检查控制台无JavaScript错误

---

## 🔧 开发工具推荐

1. **JSON验证器：**[JSONLint](https://jsonlint.com/)
2. **代码编辑器：**VS Code（安装JSON和JavaScript插件）
3. **浏览器开发工具：**Chrome DevTools（F12）
4. **本地服务器：**
   - Python: `python -m http.server 8000`
   - Node.js: `npx http-server -p 8000`

---

## 📞 需要帮助？

如果遇到问题：
1. 检查浏览器控制台（F12）的错误信息
2. 使用JSON验证器检查语法
3. 对比本文档的示例代码
4. 查看 `CLAUDE.md` 了解项目架构

---

**最后更新：** 2024年10月

**祝你顺利更新！** ✨
